# Дневной лог разработки - 2025-12-11

> **⚠️ КРИТИЧЕСКИ ВАЖНО**: В этом логе упоминается файл `ui/api/coingecko.js`, который был переименован в `ui/api/coins-manager.js` (коммит от 14.12.2025). При чтении этого лога учитывайте, что все упоминания `ui/api/coingecko.js` относятся к текущему файлу `ui/api/coins-manager.js`.

## UI (оформление)

### Коммит: [ddb24d2] - Add centralized icon system as architectural principle
- **Что сделано**: Создана централизованная система управления иконками через декларативную конфигурацию (JSON) и стили через CSS переменные, зарутованные от Bootstrap. Система задокументирована как архитектурный принцип проекта.
- **Как сделано**:
  * Создан файл `ui/config/icons-mapping.json` с соответствиями иконок и команд, разделенными по категориям (actions, navigation, status, metrics, frameworks, other). Для каждой иконки указаны: icon (CSS класс Font Awesome), title (подсказка), description (описание).
  * Создан файл `ui/styles/icons.css` с CSS переменными для цветов иконок, зарутованными от Bootstrap переменных (`--bs-body-color`, `--bs-primary`, `--bs-secondary` и т.д.). Определены стили для всех категорий иконок, hover и disabled состояний. Цвета иконок фреймворков (Vue.js, Bootstrap) определены через HSL переменные.
  * Создана утилита `ui/utils/icons-helper.js` с функциями для получения иконок по категориям: `getActionIcon()`, `getNavigationIcon()`, `getStatusIcon()`, `getMetricIcon()`, `getFrameworkIcon()`, `getOtherIcon()`, `getThemeIcon()`, `getIconTitle()`, `getIconDescription()`, `getFrameworkColor()`. Утилита асинхронно загружает JSON файл соответствий.
  * В `index.html` подключен `ui/styles/icons.css` и `ui/utils/icons-helper.js`.
  * В `ui/styles/footer.css` убраны прямые HSL значения для иконок фреймворков, теперь используются переменные из `icons.css`.
- **Функциональность**: Все соответствия иконок и команд централизованы в JSON файле, стили иконок определяются через CSS переменные, зарутованные от Bootstrap, что обеспечивает автоматическую адаптацию к темам. Система упрощает добавление новых иконок и обеспечивает консистентность стилей. Утилита предоставляет программный доступ к иконкам по категориям.

### Коммит: [897cec7] - Add centralized color and z-index system with HSL/HSLA model
- **Что сделано**: Создана централизованная система управления цветами и z-index слоями через CSS переменные, все хардкодные значения заменены на переменные, оптимизированы цвета (primary более приглушенный), исправлены цвета индикатора дуги и гамбургера.
- **Как сделано**:
  * Создан файл `ui/styles/theme-colors.css` с HSL/HSLA переменными для всех цветов темы. Primary цвет сделан более приглушенным и мягким (светлая тема: h: 208, s: 12%, l: 42%; темная тема: h: 208, s: 10%, l: 58%). Объединены дубликаты в темной теме (--color-border, --color-border-hover, --color-button-disabled используют общую переменную --color-neutral-gray). Добавлены общие переменные для переиспользования (--color-theme-h, --color-muted-s, --color-light-gray-l).
  * Создан файл `ui/styles/z-index.css` с переменными для всех z-index слоев, связанными с Bootstrap переменными. Все z-index значения заменены на переменные: --z-index-dropdown, --z-index-splash, --z-index-overlay, --z-index-footer, --z-index-header.
  * В `ui/styles/layout.css` заменены все хардкодные цвета (hex, rgba) на HSL/HSLA переменные из theme-colors.css. Индикатор дуги чекнутых монет теперь использует цвет чекнутых чекбоксов через `var(--bs-form-check-input-checked-border-color, var(--bs-form-check-input-checked-bg-color, var(--bs-primary)))`.
  * В `ui/styles/header.css` гамбургер использует цвет текста хедера через `var(--color-header-text)`. Все rgba заменены на hsla.
  * В `ui/styles/footer.css`, `ui/styles/splash.css`, `ui/styles/dropdown.css` все rgba заменены на hsla.
  * В `index.html` убраны inline z-index из dropdown меню (теперь используется CSS класс), SVG иконки используют `currentColor`, иконки Vue и Bootstrap вынесены в CSS классы в footer.css.
  * В `ui/interaction/footer.js` цвета иконок фреймворков вынесены в CSS (HSL формат).
- **Функциональность**: Все цвета и z-index значения теперь централизованы в отдельных файлах, что упрощает настройку и поддержку. Primary цвет стал более приглушенным и мягким, сохраняя контраст. Индикатор дуги чекнутых монет соответствует цвету чекбоксов. Гамбургер всегда в цвете текста хедера. Система обеспечивает консистентность и совместимость с Bootstrap.

## UX (паттерны взаимодействий)

### Коммит: [f0faaf1] - Change selected rows highlight color to greenish-cyan
- **Что сделано**: Изменен цвет подсветки выбранных строк таблицы на зеленовато-бирюзовый оттенок, удалены стили фиксированной ширины колонок таблицы.
- **Как сделано**:
  * В `ui/styles/theme-colors.css` добавлена переменная `--color-selected-h: 170` для оттенка подсветки выбранных строк (зеленовато-бирюзовый, между голубым и зеленым). Переменная определена для светлой и темной темы.
  * В `ui/styles/layout.css` изменена подсветка выбранных строк: заменено `var(--color-primary-h)` (208 - синий) на `var(--color-selected-h)` (170 - зеленовато-бирюзовый), изменен lightness с 50%/60% на 40% для обеих тем. Теперь используется `hsla(var(--color-selected-h), 100%, 40%, 0.05)` для консистентности в обеих темах.
  * Удалены стили фиксированной ширины колонок таблицы `.cg-coins-table` (table-layout, width, фиксированные ширины колонок) - таблица теперь использует автоматическую раскладку Bootstrap.
- **Функциональность**: Подсветка выбранных строк теперь имеет зеленовато-бирюзовый оттенок (hue 170), что визуально ближе к зеленому цвету и лучше выделяет выбранные элементы. Таблица использует автоматическую раскладку колонок Bootstrap вместо фиксированных ширин.

### Коммит: [77d85be] - Remove manual row movement, add Open command for Bybit
- **Что сделано**: Удалена функциональность ручного перемещения строк в контекстном меню, добавлена команда "Открыть" для открытия торговой пары монеты на Bybit в новой вкладке.
- **Как сделано**:
  * В `index.html` удалены кнопки "В начало", "Вверх", "Вниз", "В конец" из контекстного меню. Добавлена кнопка "Открыть" с иконкой `fa-external-link-alt`.
  * В `ui/api/coingecko.js` удален метод `moveToPosition()`. Добавлен метод `openCoinOnBybit()`: находит монету по `contextMenuCoin`, формирует ссылку по шаблону `https://www.bybit.com/trade/usdt/{тикер}USDT`, открывает ссылку в новой вкладке через `window.open(url, '_blank')`, обрабатывает ошибки при отсутствии монеты или тикера.
  * В `ui/config/icons-mapping.json` удалены записи о перемещении (move-to-start, move-up, move-down, move-to-end) из категории navigation. Добавлена запись "open-external" с иконкой `fa-external-link-alt` в категорию actions.
  * В `ui/guide-ii.md` обновлено описание контекстного меню: удалено упоминание перемещения, добавлено упоминание открытия на Bybit.
- **Функциональность**: Контекстное меню теперь содержит команды: "Открыть" (открывает торговую пару на Bybit), "В архив", "Удалить". Команда "Открыть" автоматически формирует ссылку на торговую пару монеты с USDT на Bybit и открывает её в новой вкладке. Функциональность ручного перемещения строк полностью удалена из интерфейса и кода.

## MM (математическая модель)

### Коммит: [70e4822] - Stage 1: Migrate math helpers, PRC weights, and PV1h clip functions
- **Что сделано**: Мигрированы базовые утилиты и функции математической модели "median" (Этап 1): базовые математические утилиты, PRC-веса и клиппинг PV1h. Все модули изолированы через IIFE для предотвращения конфликтов имен.
- **Как сделано**:
  * Создан файл `mm/median/utils/math-helpers.js` с базовыми утилитами: `clamp(x, min, max)` - ограничение значения в диапазоне, `safeNumber(x, def)` - безопасное преобразование в число, `tanh(x)` - гиперболический тангенс, `median(arr)` - вычисление медианы массива. Все функции экспортируются через `window.mmMedianHelpers`.
  * Создан файл `mm/median/core/prc-weights.js` с функцией `computePRCWeights(hDays)` для расчета PRC-весов (Proximity Relevance Coefficients) для заданного горизонта прогноза. Обновлен массив `timeFramesDays` для новых интервалов CoinGecko: `[1/24, 1, 7, 14, 30, 200]` (вместо старых `[1/24, 1, 7, 30, 60, 90]`). Экспортируется через `window.mmMedianPRCWeights`, также экспортируется `timeFramesDays` для использования в UI.
  * Создан файл `mm/median/core/pv1h-clip.js` с функциями `computePV1hClipThreshold(coins)` - расчет порога клиппинга (99-й перцентиль), `smoothPV1h(pv1h)` - сглаживание PV1h с клиппингом, `setPV1hClip(threshold)`, `getPV1hClip()`. Константа `EPSILON = 0.2` для порога чувствительности. Экспортируется через `window.mmMedianPV1hClip`.
  * Все файлы обернуты в IIFE (Immediately Invoked Function Expression) для изоляции области видимости и предотвращения конфликтов имен переменных (`clamp`, `safeNumber`). Переменные внутри IIFE переименованы (`clampFn`, `safeNumberFn`) для избежания конфликтов.
  * Все файлы подключены в `index.html` в правильном порядке: после Vue.js, перед компонентами. Порядок загрузки: `math-helpers.js` → `prc-weights.js` → `pv1h-clip.js` (зависимости).
  * В `migration-plan.md` обновлен статус Этапа 1 как завершенного, добавлена запись в историю изменений.
  * В `architect.md` добавлены новые файлы в раздел "Текущее размещение файлов".
- **Функциональность**: Базовые утилиты и функции математической модели "median" мигрированы из старого приложения. Все модули изолированы через IIFE, что предотвращает конфликты имен переменных. PRC-веса адаптированы для новых интервалов CoinGecko (14d, 200d вместо 60d, 90d). Все функции доступны через `window.mmMedian*` для использования в других модулях и компонентах.

### Коммит: [dddc5c8] - Stage 2: Migrate CPT calculation and create Complex Deltas tab with stubs
- **Что сделано**: Мигрирован расчет CPT (Coin Potential) для математической модели "median" (Этап 2), создана вкладка "Комплексные дельты" с таблицей и заглушками для CD значений.
- **Как сделано**:
  * Создан файл `mm/median/metrics/cpt.js` с функциями `computeEnhancedCPT(values, hDays)` - расчет улучшенного CPT с адаптацией весов к горизонту прогноза, `formatEnhancedCPT(value)` - форматирование CPT для отображения (формат "+X.XX" или "-X.XX"). Базовые веса `baseW` адаптированы для новых интервалов CoinGecko: `[0.38, 0.32, 0.18, 0.08, 0.03, 0.01]` для `[1h, 24h, 7d, 14d, 30d, 200d]`. Файл обернут в IIFE для изоляции области видимости. Экспортируется через `window.mmMedianCPT`.
  * В `ui/api/coingecko.js` добавлен метод `calculateCPT(coin, hDays)` для расчета CPT для монеты. CPT рассчитывается при обновлении данных монет (`fetchCoinGecko`), при добавлении топ монет (`addTopCoinsByMarketCap`, `addTopCoinsByVolume`), при загрузке из localStorage (в `mounted()` хуке). Результаты сохраняются в `coin.enhancedCpt` и `coin.enhancedCptFormatted`.
  * Создан компонент `ui/api/complex-deltas.js` для таблицы "Комплексные дельты". Компонент отображает таблицу с колонками: №, Тикер, CDH, CD6, CD5, CD4, CD3, CD2, CD1. CDH выделяется цветом (как в старом приложении). Поддерживает сортировку по колонкам через mixin. Использует заглушки для CD значений (частичные суммы `pvs`) до миграции Этапа 3. Динамическая позиция CDH вставляется в зависимости от горизонта прогноза.
  * В `index.html` добавлен x-template для компонента `complex-deltas-template`, компонент подключен с условием `activeTab === 'complex-deltas'`. В хедере уже была вкладка "Компл. дельты" с id `complex-deltas`.
  * В `app/app-ui-root.js` зарегистрирован компонент `app-complex-deltas`.
  * В `ui/styles/layout.css` добавлены стили для колонки CDH: цвет `hsl(200, 44%, 55%)` для светлой темы, `hsl(200, 50%, 65%)` для темной темы, `font-weight: bold`.
  * В `migration-plan.md` обновлен статус Этапа 2 как завершенного, добавлена запись в историю изменений.
  * В `architect.md` добавлены новые файлы в раздел "Текущее размещение файлов": `mm/median/metrics/cpt.js`, `ui/api/complex-deltas.js`.
- **Функциональность**: CPT (Coin Potential) рассчитывается для всех монет при обновлении данных и при загрузке из localStorage. CPT сохраняется в `coin.enhancedCpt` (число) и `coin.enhancedCptFormatted` (строка вида "+X.XX" или "-X.XX"). Вкладка "Комплексные дельты" отображает таблицу с заглушками для CD значений, которые будут заменены реальными расчетами после миграции Этапа 3. Таблица поддерживает сортировку по колонкам, CDH выделяется цветом. Все модули изолированы через IIFE, что предотвращает конфликты имен.

## Architect (архитектура, настройки)

### Коммит: [70e4822] - Add migration plan for mathematical model and transform CoinGecko data to PV format

### Коммит: [32b78cc] - Update migration plan: multiple math models architecture with median model
- **Что сделано**: Создан подробный план миграции математической модели из старого приложения, добавлена трансформация данных CoinGecko в формат со старыми переменными (pvs), обновлена документация
- **Как сделано**:
  * Создан файл `migration-plan.md` в корне проекта с пошаговым планом миграции (12 этапов)
  * Каждый этап содержит: цель, конкретные шаги, команды для проверки в консоли, описание следующего элемента интерфейса для проверки
  * Добавлен раздел "Проблемы и решения миграции" с описанием 4 ключевых проблем (изменение интервалов, зависимость от рыночных индикаторов, корреляция с BTC, независимость MDN)
  * Создана функция `transformCoinGeckoToPV()` в `ui/api/coingecko.js` для трансформации данных CoinGecko в формат со старыми переменными:
    - Массив `pvs` из 6 элементов (PV1h, PV24h, PV7d, PV14d, PV30d, PV200d)
    - Отдельные переменные PV1h, PV24h, PV7d, PV14d, PV30d, PV200d для совместимости
  * Применена трансформация во всех местах получения данных от CoinGecko API:
    - В `fetchCoinGecko()` - основной метод загрузки данных
    - В `addTopCoinsByMarketCap()` - добавление топ монет по капитализации
    - В `addTopCoinsByVolume()` - добавление топ монет по объему
    - При загрузке из localStorage - для обратной совместимости со старыми данными
  * Добавлена секция "Проблемы миграции математической модели" в `architect.md` с описанием текущих проблем и ссылками на план миграции
  * Обновлен `.cursorrules` с ссылкой на план миграции в разделе о работе со старыми файлами
  * Все изменения подробно прокомментированы с указанием источника (old_app_not_write/parsing.js)
- **Функциональность**: Обеспечена преемственность переменных и структуры данных для плавной миграции математической модели. Все монеты теперь имеют формат со старыми переменными (pvs, PV1h и т.д.), что позволяет использовать существующие функции расчета из старого приложения. План миграции служит руководством для пошагового переноса функциональности с четкими инструкциями по проверке каждого этапа.

- **Что сделано**: Обновлена архитектура математических моделей: теперь в приложении будет несколько математических моделей (в отличие от старого приложения, где была только одна). Текущая модель - "median" (модель расчета AGR по медианам). Обновлена структура папок и экспорты функций.
- **Как сделано**:
  * В `migration-plan.md` обновлена структура папок: `mm/utils/`, `mm/core/`, `mm/metrics/` → `mm/median/utils/`, `mm/median/core/`, `mm/median/metrics/`
  * Обновлены все пути к файлам в плане миграции (12 этапов) с учетом новой структуры
  * Обновлены экспорты функций: `window.mm*` → `window.mmMedian*` (например, `window.mmPRCWeights` → `window.mmMedianPRCWeights`)
  * Добавлено описание AGR как конечного показателя пригодности монеты к торговле (в разных масштабах и размерностях для разных математических моделей)
  * Добавлено примечание о возможности добавления других моделей в будущем (например, `mm/momentum/`, `mm/trend/`)
  * В `architect.md` добавлен раздел "Архитектура математических моделей" в секции "MM (математическая модель)" с описанием структуры и принципов
  * Обновлена иерархия метрик в `migration-plan.md` с указанием, что это модель "median"
- **Функциональность**: Архитектура теперь поддерживает несколько математических моделей, каждая в своей папке. Текущая модель "median" мигрируется из старого приложения. AGR определен как конечный показатель пригодности монеты к торговле, который может иметь разные масштабы и размерности в разных моделях. Структура позволяет легко добавлять новые модели в будущем.

### Коммит: [ddb24d2] - Add centralized icon system as architectural principle
- **Что сделано**: Система иконок задокументирована как архитектурный принцип проекта, аналогичный цветовой модели HSL/HSLA и системе z-index слоев.
- **Как сделано**:
  * В `architect.md` усилен раздел "Система иконок" с добавлением подраздела "Концепт централизованного управления иконками". Описаны принципы разделения ответственности: декларативная конфигурация (JSON), стили через CSS переменные, программный доступ через утилиту. Указано, что это архитектурный принцип проекта, аналогичный цветовой модели HSL/HSLA и системе z-index слоев. Обновлен раздел "Стандарты разработки" с упоминанием системы иконок как архитектурного принципа. Обновлена структура проекта с добавлением `ui/config/` и `ui/utils/icons-helper.js`.
  * В `ui/guide-ii.md` расширено описание централизованной системы иконок в разделе "Иконки" с указанием, что это архитектурный принцип проекта.
  * В `.cursorrules` добавлена запись в историю изменений предпочтений о концепте системы иконок как архитектурного принципа проекта с указанием даты (2025-12-11) и мест документации.
- **Функциональность**: Система иконок теперь оформлена как архитектурный принцип проекта, наравне с цветовой моделью HSL/HSLA и системой z-index слоев. Документация отражает концептуальную основу системы и её роль в архитектуре проекта. ИИ-агенты и разработчики имеют полное понимание системы иконок как архитектурного принципа.

### Коммит: [897cec7] - Add centralized color and z-index system with HSL/HSLA model
- **Что сделано**: Добавлена документация о системе цветов HSL/HSLA и системе z-index слоев как архитектурных принципах проекта.
- **Как сделано**:
  * В `ui/guide-ii.md` добавлен раздел "Цветовая модель HSL/HSLA" с описанием принципа, преимуществ (интуитивность, легкость создания вариаций, адаптация под темы, централизованное управление), реализации в проекте и связи с Bootstrap. Обновлены упоминания z-index в компонентах (хедер, футер, сплэш-экран) с указанием используемых переменных.
  * В `architect.md` добавлено упоминание системы z-index слоев в разделе "Стандарты разработки" и создан новый раздел "Система z-index слоев" с описанием принципа, преимуществ, структуры переменных, правил использования и связи с Bootstrap. Добавлено упоминание цветовой модели HSL/HSLA в стандартах разработки.
  * В `.cursorrules` обновлена история изменений предпочтений: добавлены записи о концепте цветовой модели HSL/HSLA и концепте системы z-index слоев как архитектурных принципах проекта.
- **Функциональность**: Документация теперь полностью описывает систему цветов HSL/HSLA и систему z-index слоев как архитектурные принципы проекта. ИИ-агенты и разработчики имеют полное понимание этих систем и правил их использования.

### Коммит: [560920e] - Update documentation: add new rules, remove BOT references, remove metrics caching
- **Что сделано**: Обновлена документация проекта: добавлены новые правила работы ИИ-агента (ознакомление с документацией при открытии дня, терминология "Друг", команда П:), убраны упоминания "BOT" из заголовков документации, удалено кэширование метрик рынка из footer.js.
- **Как сделано**:
  * В `.cursorrules` добавлен раздел "При открытии нового рабочего дня" с правилом обязательного ознакомления с документацией (`.cursorrules`, `architect.md`, `ui/guide-ii.md`) при открытии нового рабочего дня, проверки актуальности зависимостей и состояния проекта.
  * В `.cursorrules` добавлено правило терминологии "Друг": когда пользователь упоминает "Друга" (с большой буквы), имеется в виду размышляющая модель Sonet 4.5, с которой у пользователя сложились хорошие отношения и доверие.
  * В `.cursorrules` добавлена команда П: для фиксации принципов и глобальных концептов. Команда требует тщательного анализа принципа, декомпозиции идеи и размещения документации в одном или нескольких документах, где это наиболее уместно (`.cursorrules`, `architect.md`, `ui/guide-ii.md` и другие).
  * В `architect.md` убрано упоминание "(BOT)" из заголовка "Архитектурный план", в структуре проекта заменено "BOT/" на "Root/".
  * В `ui/guide-ii.md` убрано упоминание "(BOT)" из заголовка "Руководство по интерфейсу и взаимодействию".
  * В `ui/interaction/footer.js` удалено кэширование метрик рынка: убраны методы `filterSpinnerChars()`, `applyMetrics()`, убрана логика проверки кэша перед загрузкой и сохранения метрик в кэш после загрузки. Метрики теперь загружаются напрямую из API без кэширования.
- **Функциональность**: Документация проекта обновлена с новыми правилами работы ИИ-агента, упоминания "BOT" удалены для унификации названий. Кэширование метрик рынка удалено из footer.js - метрики теперь загружаются напрямую при каждом обновлении без использования кэша localStorage.

### Коммит: [07c6c3a] - Fix date handling: use Moscow timezone and correct log date
- **Что сделано**: Исправлена дата дневного лога с 12-12 на 12-11, добавлено правило определения даты по московскому времени для дневных логов и документации, исправлены даты в истории изменений предпочтений.
- **Как сделано**:
  * Файл дневного лога переименован с `history/2025/12-12.txt` на `history/2025/12-11.txt`, дата в заголовке исправлена на 2025-12-11.
  * В `.cursorrules` добавлено правило определения даты по московскому времени (MSK, UTC+3) для дневных логов и всех дат в документации проекта. ИИ-агент должен учитывать московский часовой пояс при создании файла дневного лога, указании даты в заголовке и при заносе дат в любую документацию (`.cursorrules`, `architect.md`, `ui/guide-ii.md` и другие документы).
  * В разделе "История изменений предпочтений" исправлены даты с `2025-12-12` на `2025-12-11` для трех записей: правило ознакомления с документацией, правило терминологии "Друг", команда П:.
- **Функциональность**: Все даты в документации теперь определяются по московскому времени (MSK, UTC+3). Дневной лог создан с правильной датой 12-11. Правило обеспечивает консистентность дат во всей документации проекта.

### Коммит: [3d6f705] - Remove defaultCoins, fix search input, add top N coins feature, fix group archiving
- **Что сделано**: Убран список монет по умолчанию, исправлен поиск монет, добавлена функциональность добавления топ N монет по числу, исправлено групповое архивирование.
- **Как сделано**:
  * В `ui/api/coingecko.js` удален массив `defaultCoins`, теперь список монет по умолчанию пустой (`[]`). Пользователь сам формирует список монет через поиск или вставку тикеров.
  * Исправлен метод `handleSearchInput()`: теперь принимает значение напрямую (строку из компонента `header-coins`), а не объект события. Добавлена обратная совместимость для случаев, когда передается объект события.
  * Добавлена функциональность добавления топ N монет: при вводе числа (например, "50") в поле поиска автоматически появляются два кастомных пункта ("Топ N по капитализации" и "Топ N по дневному объему"). Добавлены методы `addTopCoinsByMarketCap(count)` и `addTopCoinsByVolume(count)` для загрузки топ монет из CoinGecko API. Метод `handleAddCoin()` проверяет тип результата поиска и вызывает соответствующий метод для кастомных пунктов.
  * Исправлен порядок операций в методе `archiveSelectedCoins()`: сначала находится монета в `cgCoins`, затем синхронизируется (удаляется из таблицы), затем добавляется в архив. Это исправляет проблему, когда монеты удалялись вместо архивирования при групповом архивировании.
  * В `index.html` обновлен шаблон результатов поиска для корректного отображения кастомных пунктов (без иконки, без проверки выбранности).
  * В `ui/guide-ii.md` обновлено описание поиска монет с упоминанием функциональности добавления топ N монет.
  * В `architect.md` обновлено описание компонента `coingecko.js` с упоминанием добавления топ N монет.
- **Функциональность**: Список монет по умолчанию теперь пустой, пользователь сам формирует список. Поиск монет работает корректно. При вводе числа в поле поиска появляются кастомные пункты для быстрого добавления топ монет по капитализации или объему. Групповое архивирование теперь корректно добавляет монеты в архив, а не просто удаляет их из таблицы.

### Коммит: [211135a] - Add reusable column visibility mixin and document view switching pattern
- **Что сделано**: Создан переиспользуемый Vue mixin для управления видимостью колонок таблицы через вкладки, добавлена подробная документация парадигмы переключения представлений (View Switching Pattern) и её взаимосвязи с управлением видимостью колонок.
- **Как сделано**:
  * Создан файл `ui/utils/column-visibility-mixin.js` с переиспользуемым Vue mixin для управления видимостью колонок таблицы. Mixin содержит computed свойства: `activeTab()` - реактивное получение активного представления из корневого компонента, `columnVisibilityClasses()` - вычисление CSS классов видимости для колонок на основе конфигурации и активного представления. Поддерживается префиксное совпадение классов (например, 'col-percent' скрывает все 'col-percent-*'). Опциональный метод `getColumnClasses()` для явного указания всех классов колонок.
  * В `ui/api/coingecko.js` подключен mixin `columnVisibilityMixin`, добавлена конфигурация `columnVisibilityConfig` в `data()` с маппингом представлений на скрываемые колонки. Добавлен метод `getColumnClasses()` для явного указания классов колонок. Удалена старая логика `columnVisibilityClasses()` из computed, заменена на использование mixin.
  * В `ui/styles/layout.css` обновлены CSS правила для универсальности: убрана привязка к конкретному классу `.cg-coins-table`, добавлено универсальное правило `table th.col-hidden, table td.col-hidden { display: none; }` для работы с любыми таблицами. Правило `col.col-hidden { width: 0; }` оставлено для скрытия колонок через colgroup.
  * В `index.html` добавлен `<script src="./ui/utils/column-visibility-mixin.js"></script>` перед `coingecko.js` для загрузки mixin.
  * В `architect.md` добавлен новый раздел "Парадигма переключения представлений (View Switching Pattern)" с подробным описанием архитектурной модели (Single Source of Truth), компонентов парадигмы (централизованное состояние, управление переключением, реактивное распространение, UI компоненты), преимуществ, структуры данных, правил использования и связи с другими паттернами. Обновлен раздел "Переиспользуемая фича: Управление видимостью колонок таблицы через вкладки" с описанием архитектурной интеграции с парадигмой переключения представлений, зависимости от централизованного состояния, реактивного обновления, конфигурации представлений и мгновенного переключения.
  * В `ui/guide-ii.md` обновлены разделы "Вкладки отображения" и "Активная вкладка" с описанием парадигмы переключения представлений, централизованного управления состоянием, реактивности и персистентности.
- **Функциональность**: Создана переиспользуемая фича для управления видимостью колонок таблицы через вкладки, которая может применяться к любым таблицам с любыми наборами вкладок. Mixin интегрируется с парадигмой переключения представлений через реактивное отслеживание `activeTab` из корневого компонента. Использование CSS классов обеспечивает мгновенное переключение видимости колонок без перерисовки таблицы. Документация описывает архитектурную модель переключения представлений как Single Source of Truth с реактивным распространением состояния, что обеспечивает единообразие и расширяемость системы.

### Коммит: [6fc742f] - Refactor: remove complex-deltas component, add reusable sortable-header and table-coin-row components
- **Что сделано**: Удален компонент `complex-deltas.js`, функциональность перенесена в `coingecko.js`. Добавлены переиспользуемые компоненты `sortable-header.js` и `table-coin-row.js`. Обновлена логика переключения вкладок для поддержки вкладки "Компл. дельты".
- **Как сделано**:
  * Удален файл `ui/api/complex-deltas.js` - функциональность отображения комплексных дельт перенесена в компонент `coingecko.js`, таблица отображается на вкладке "Компл. дельты" через условный рендеринг того же компонента `app-coingecko`.
  * Создан файл `ui/components/sortable-header.js` - переиспользуемый компонент для сортируемых заголовков таблиц. Компонент принимает props: `field` (поле для сортировки), `label` (текст заголовка), `sortBy` (текущее поле сортировки), `sortOrder` (текущий порядок сортировки). Computed свойства: `isActive()` - проверка активности сортировки, `sortIcon()` - определение иконки сортировки (fas fa-sort, fas fa-sort-up, fas fa-sort-down). Метод `handleClick()` эмитит событие `sort` с полем для сортировки. Использует x-template `#sortable-header-template`.
  * Создан файл `ui/components/table-coin-row.js` - переиспользуемый компонент для первых двух колонок таблицы (№ и Тикер). Компонент обеспечивает единообразие отображения первых двух колонок во всех таблицах вкладок математической модели Median. Принимает props: `index` (индекс строки для номера), `coin` (объект монеты). Методы: `getBybitLink(ticker)` - формирование ссылки на Bybit, `getTicker(coin)` - получение тикера монеты. Использует x-template `#table-coin-row-template`.
  * В `app/app-ui-root.js` удалена регистрация компонента `app-complex-deltas`, добавлена регистрация компонента `sortable-header`. Компонент регистрируется глобально для использования в любых таблицах.
  * В `ui/interaction/header.js` обновлена логика переключения вкладок: метод `switchTab()` теперь закрывает настройки при переключении на вкладку "Компл. дельты" (в дополнение к вкладке "%"). Убрана замена "Компл. дельты" на "Дельты" в мобильной версии из computed свойства `selectedTabLabel()` - теперь всегда отображается полное название "Компл. дельты".
- **Функциональность**: Компонент комплексных дельт удален, функциональность интегрирована в основной компонент `coingecko.js`, что упрощает поддержку и обеспечивает единообразие отображения данных. Переиспользуемые компоненты `sortable-header` и `table-coin-row` обеспечивают консистентность интерфейса во всех таблицах приложения. Логика переключения вкладок обновлена для корректной работы с вкладкой "Компл. дельты". Компоненты могут использоваться в любых таблицах приложения для обеспечения единообразия интерфейса.

