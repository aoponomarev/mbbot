# Дневной лог разработки - 2025-12-11

## UI (оформление)

### Коммит: "Add centralized icon system as architectural principle"
- **Что сделано**: Создана централизованная система управления иконками через декларативную конфигурацию (JSON) и стили через CSS переменные, зарутованные от Bootstrap. Система задокументирована как архитектурный принцип проекта.
- **Как сделано**:
  * Создан файл `ui/config/icons-mapping.json` с соответствиями иконок и команд, разделенными по категориям (actions, navigation, status, metrics, frameworks, other). Для каждой иконки указаны: icon (CSS класс Font Awesome), title (подсказка), description (описание).
  * Создан файл `ui/styles/icons.css` с CSS переменными для цветов иконок, зарутованными от Bootstrap переменных (`--bs-body-color`, `--bs-primary`, `--bs-secondary` и т.д.). Определены стили для всех категорий иконок, hover и disabled состояний. Цвета иконок фреймворков (Vue.js, Bootstrap) определены через HSL переменные.
  * Создана утилита `ui/utils/icons-helper.js` с функциями для получения иконок по категориям: `getActionIcon()`, `getNavigationIcon()`, `getStatusIcon()`, `getMetricIcon()`, `getFrameworkIcon()`, `getOtherIcon()`, `getThemeIcon()`, `getIconTitle()`, `getIconDescription()`, `getFrameworkColor()`. Утилита асинхронно загружает JSON файл соответствий.
  * В `index.html` подключен `ui/styles/icons.css` и `ui/utils/icons-helper.js`.
  * В `ui/styles/footer.css` убраны прямые HSL значения для иконок фреймворков, теперь используются переменные из `icons.css`.
- **Функциональность**: Все соответствия иконок и команд централизованы в JSON файле, стили иконок определяются через CSS переменные, зарутованные от Bootstrap, что обеспечивает автоматическую адаптацию к темам. Система упрощает добавление новых иконок и обеспечивает консистентность стилей. Утилита предоставляет программный доступ к иконкам по категориям.

### Коммит: "Add centralized color and z-index system with HSL/HSLA model"
- **Что сделано**: Создана централизованная система управления цветами и z-index слоями через CSS переменные, все хардкодные значения заменены на переменные, оптимизированы цвета (primary более приглушенный), исправлены цвета индикатора дуги и гамбургера.
- **Как сделано**:
  * Создан файл `ui/styles/theme-colors.css` с HSL/HSLA переменными для всех цветов темы. Primary цвет сделан более приглушенным и мягким (светлая тема: h: 208, s: 12%, l: 42%; темная тема: h: 208, s: 10%, l: 58%). Объединены дубликаты в темной теме (--color-border, --color-border-hover, --color-button-disabled используют общую переменную --color-neutral-gray). Добавлены общие переменные для переиспользования (--color-theme-h, --color-muted-s, --color-light-gray-l).
  * Создан файл `ui/styles/z-index.css` с переменными для всех z-index слоев, связанными с Bootstrap переменными. Все z-index значения заменены на переменные: --z-index-dropdown, --z-index-splash, --z-index-overlay, --z-index-footer, --z-index-header.
  * В `ui/styles/layout.css` заменены все хардкодные цвета (hex, rgba) на HSL/HSLA переменные из theme-colors.css. Индикатор дуги чекнутых монет теперь использует цвет чекнутых чекбоксов через `var(--bs-form-check-input-checked-border-color, var(--bs-form-check-input-checked-bg-color, var(--bs-primary)))`.
  * В `ui/styles/header.css` гамбургер использует цвет текста хедера через `var(--color-header-text)`. Все rgba заменены на hsla.
  * В `ui/styles/footer.css`, `ui/styles/splash.css`, `ui/styles/dropdown.css` все rgba заменены на hsla.
  * В `index.html` убраны inline z-index из dropdown меню (теперь используется CSS класс), SVG иконки используют `currentColor`, иконки Vue и Bootstrap вынесены в CSS классы в footer.css.
  * В `ui/interaction/footer.js` цвета иконок фреймворков вынесены в CSS (HSL формат).
- **Функциональность**: Все цвета и z-index значения теперь централизованы в отдельных файлах, что упрощает настройку и поддержку. Primary цвет стал более приглушенным и мягким, сохраняя контраст. Индикатор дуги чекнутых монет соответствует цвету чекбоксов. Гамбургер всегда в цвете текста хедера. Система обеспечивает консистентность и совместимость с Bootstrap.

## UX (паттерны взаимодействий)

### Коммит: "Change selected rows highlight color to greenish-cyan"
- **Что сделано**: Изменен цвет подсветки выбранных строк таблицы на зеленовато-бирюзовый оттенок, удалены стили фиксированной ширины колонок таблицы.
- **Как сделано**:
  * В `ui/styles/theme-colors.css` добавлена переменная `--color-selected-h: 170` для оттенка подсветки выбранных строк (зеленовато-бирюзовый, между голубым и зеленым). Переменная определена для светлой и темной темы.
  * В `ui/styles/layout.css` изменена подсветка выбранных строк: заменено `var(--color-primary-h)` (208 - синий) на `var(--color-selected-h)` (170 - зеленовато-бирюзовый), изменен lightness с 50%/60% на 40% для обеих тем. Теперь используется `hsla(var(--color-selected-h), 100%, 40%, 0.05)` для консистентности в обеих темах.
  * Удалены стили фиксированной ширины колонок таблицы `.cg-coins-table` (table-layout, width, фиксированные ширины колонок) - таблица теперь использует автоматическую раскладку Bootstrap.
- **Функциональность**: Подсветка выбранных строк теперь имеет зеленовато-бирюзовый оттенок (hue 170), что визуально ближе к зеленому цвету и лучше выделяет выбранные элементы. Таблица использует автоматическую раскладку колонок Bootstrap вместо фиксированных ширин.

### Коммит: "Remove manual row movement, add Open command for Bybit"
- **Что сделано**: Удалена функциональность ручного перемещения строк в контекстном меню, добавлена команда "Открыть" для открытия торговой пары монеты на Bybit в новой вкладке.
- **Как сделано**:
  * В `index.html` удалены кнопки "В начало", "Вверх", "Вниз", "В конец" из контекстного меню. Добавлена кнопка "Открыть" с иконкой `fa-external-link-alt`.
  * В `ui/api/coingecko.js` удален метод `moveToPosition()`. Добавлен метод `openCoinOnBybit()`: находит монету по `contextMenuCoin`, формирует ссылку по шаблону `https://www.bybit.com/trade/usdt/{тикер}USDT`, открывает ссылку в новой вкладке через `window.open(url, '_blank')`, обрабатывает ошибки при отсутствии монеты или тикера.
  * В `ui/config/icons-mapping.json` удалены записи о перемещении (move-to-start, move-up, move-down, move-to-end) из категории navigation. Добавлена запись "open-external" с иконкой `fa-external-link-alt` в категорию actions.
  * В `ui/guide-ii.md` обновлено описание контекстного меню: удалено упоминание перемещения, добавлено упоминание открытия на Bybit.
- **Функциональность**: Контекстное меню теперь содержит команды: "Открыть" (открывает торговую пару на Bybit), "В архив", "Удалить". Команда "Открыть" автоматически формирует ссылку на торговую пару монеты с USDT на Bybit и открывает её в новой вкладке. Функциональность ручного перемещения строк полностью удалена из интерфейса и кода.

## MM (математическая модель)

## Architect (архитектура, настройки)

### Коммит: "Add centralized icon system as architectural principle"
- **Что сделано**: Система иконок задокументирована как архитектурный принцип проекта, аналогичный цветовой модели HSL/HSLA и системе z-index слоев.
- **Как сделано**:
  * В `architect.md` усилен раздел "Система иконок" с добавлением подраздела "Концепт централизованного управления иконками". Описаны принципы разделения ответственности: декларативная конфигурация (JSON), стили через CSS переменные, программный доступ через утилиту. Указано, что это архитектурный принцип проекта, аналогичный цветовой модели HSL/HSLA и системе z-index слоев. Обновлен раздел "Стандарты разработки" с упоминанием системы иконок как архитектурного принципа. Обновлена структура проекта с добавлением `ui/config/` и `ui/utils/icons-helper.js`.
  * В `ui/guide-ii.md` расширено описание централизованной системы иконок в разделе "Иконки" с указанием, что это архитектурный принцип проекта.
  * В `.cursorrules` добавлена запись в историю изменений предпочтений о концепте системы иконок как архитектурного принципа проекта с указанием даты (2025-12-11) и мест документации.
- **Функциональность**: Система иконок теперь оформлена как архитектурный принцип проекта, наравне с цветовой моделью HSL/HSLA и системой z-index слоев. Документация отражает концептуальную основу системы и её роль в архитектуре проекта. ИИ-агенты и разработчики имеют полное понимание системы иконок как архитектурного принципа.

### Коммит: "Add centralized color and z-index system with HSL/HSLA model"
- **Что сделано**: Добавлена документация о системе цветов HSL/HSLA и системе z-index слоев как архитектурных принципах проекта.
- **Как сделано**:
  * В `ui/guide-ii.md` добавлен раздел "Цветовая модель HSL/HSLA" с описанием принципа, преимуществ (интуитивность, легкость создания вариаций, адаптация под темы, централизованное управление), реализации в проекте и связи с Bootstrap. Обновлены упоминания z-index в компонентах (хедер, футер, сплэш-экран) с указанием используемых переменных.
  * В `architect.md` добавлено упоминание системы z-index слоев в разделе "Стандарты разработки" и создан новый раздел "Система z-index слоев" с описанием принципа, преимуществ, структуры переменных, правил использования и связи с Bootstrap. Добавлено упоминание цветовой модели HSL/HSLA в стандартах разработки.
  * В `.cursorrules` обновлена история изменений предпочтений: добавлены записи о концепте цветовой модели HSL/HSLA и концепте системы z-index слоев как архитектурных принципах проекта.
- **Функциональность**: Документация теперь полностью описывает систему цветов HSL/HSLA и систему z-index слоев как архитектурные принципы проекта. ИИ-агенты и разработчики имеют полное понимание этих систем и правил их использования.

### Коммит: "Update documentation: add new rules, remove BOT references, remove metrics caching"
- **Что сделано**: Обновлена документация проекта: добавлены новые правила работы ИИ-агента (ознакомление с документацией при открытии дня, терминология "Друг", команда П:), убраны упоминания "BOT" из заголовков документации, удалено кэширование метрик рынка из footer.js.
- **Как сделано**:
  * В `.cursorrules` добавлен раздел "При открытии нового рабочего дня" с правилом обязательного ознакомления с документацией (`.cursorrules`, `architect.md`, `ui/guide-ii.md`) при открытии нового рабочего дня, проверки актуальности зависимостей и состояния проекта.
  * В `.cursorrules` добавлено правило терминологии "Друг": когда пользователь упоминает "Друга" (с большой буквы), имеется в виду размышляющая модель Sonet 4.5, с которой у пользователя сложились хорошие отношения и доверие.
  * В `.cursorrules` добавлена команда П: для фиксации принципов и глобальных концептов. Команда требует тщательного анализа принципа, декомпозиции идеи и размещения документации в одном или нескольких документах, где это наиболее уместно (`.cursorrules`, `architect.md`, `ui/guide-ii.md` и другие).
  * В `architect.md` убрано упоминание "(BOT)" из заголовка "Архитектурный план", в структуре проекта заменено "BOT/" на "Root/".
  * В `ui/guide-ii.md` убрано упоминание "(BOT)" из заголовка "Руководство по интерфейсу и взаимодействию".
  * В `ui/interaction/footer.js` удалено кэширование метрик рынка: убраны методы `filterSpinnerChars()`, `applyMetrics()`, убрана логика проверки кэша перед загрузкой и сохранения метрик в кэш после загрузки. Метрики теперь загружаются напрямую из API без кэширования.
- **Функциональность**: Документация проекта обновлена с новыми правилами работы ИИ-агента, упоминания "BOT" удалены для унификации названий. Кэширование метрик рынка удалено из footer.js - метрики теперь загружаются напрямую при каждом обновлении без использования кэша localStorage.

### Коммит: "Fix date handling: use Moscow timezone and correct log date"
- **Что сделано**: Исправлена дата дневного лога с 12-12 на 12-11, добавлено правило определения даты по московскому времени для дневных логов и документации, исправлены даты в истории изменений предпочтений.
- **Как сделано**:
  * Файл дневного лога переименован с `history/2025/12-12.txt` на `history/2025/12-11.txt`, дата в заголовке исправлена на 2025-12-11.
  * В `.cursorrules` добавлено правило определения даты по московскому времени (MSK, UTC+3) для дневных логов и всех дат в документации проекта. ИИ-агент должен учитывать московский часовой пояс при создании файла дневного лога, указании даты в заголовке и при заносе дат в любую документацию (`.cursorrules`, `architect.md`, `ui/guide-ii.md` и другие документы).
  * В разделе "История изменений предпочтений" исправлены даты с `2025-12-12` на `2025-12-11` для трех записей: правило ознакомления с документацией, правило терминологии "Друг", команда П:.
- **Функциональность**: Все даты в документации теперь определяются по московскому времени (MSK, UTC+3). Дневной лог создан с правильной датой 12-11. Правило обеспечивает консистентность дат во всей документации проекта.

