# Дневной лог разработки - 14 декабря 2025

## UI (оформление)

### Коммит: Fix window.uiElementHelper access in Vue templates and restore icons catalog
- **Что сделано**: Исправлена проблема с доступом к `window.uiElementHelper` в шаблонах Vue, восстановлен каталог иконок и документация из коммита b04fb21
- **Как сделано**:
  * **Восстановление изменений из коммита b04fb21**:
    - Восстановлен файл `ui/assets/icons-review.html` - интерактивный каталог всех иконок проекта
    - Восстановлен файл `ui/assets/icons/icon-cross.svg` - SVG иконка крестика
    - Восстановлены обновления в `ui/config/ui-element-mapping.json` с командами для иконки крестика
    - Восстановлены обновления в `ui/styles/icons.css` со стилями для SVG иконки крестика
    - Восстановлены обновления в `ui/utils/ui-element-helper.js` с функциями для работы с SVG иконками
    - Восстановлены обновления документации в `architect.md` и `ui/guide-ii.md` про каталог иконок
  * **Исправление проблемы window.uiElementHelper**:
    - Добавлены computed свойства в `ui/components/button.js`:
      - `uiElementHelper()` - безопасный доступ к `window.uiElementHelper`
      - `isSVGIcon()` - проверка, является ли иконка SVG
      - `svgIconPath()` - путь к SVG иконке
    - Добавлены computed свойства в `ui/components/menu-item.js`:
      - `uiElementHelper()` - безопасный доступ к `window.uiElementHelper`
      - `isSVGIcon()` - проверка, является ли иконка SVG
      - `svgIconPath()` - путь к SVG иконке
    - Обновлены шаблоны в `index.html`:
      - В шаблоне `button-template` заменены прямые обращения `window.uiElementHelper.isSVGIcon()` и `window.uiElementHelper.getSVGIconPath()` на computed свойства `isSVGIcon` и `svgIconPath`
      - В шаблоне `menu-item-template` заменены прямые обращения `window.uiElementHelper.isSVGIcon()` и `window.uiElementHelper.getSVGIconPath()` на computed свойства `isSVGIcon` и `svgIconPath`
- **Функциональность**: Кнопки и выпадающие списки теперь работают корректно, так как доступ к `window.uiElementHelper` в шаблонах Vue осуществляется через computed свойства, которые безопасно обрабатывают случаи, когда `window` недоступен. Каталог иконок восстановлен и доступен для просмотра всех иконок проекта.

## UX (паттерны взаимодействий)

### Коммит: Fix dropdown menu opening issue and remove debug logging
- **Что сделано**: Исправлена проблема с открытием выпадающего меню кнопки "Избранное" и удалено отладочное логирование
- **Как сделано**:
  * **Исправление проблемы с открытием меню**:
    - Добавлен флаг `isTogglingFavorites` в `ui/components/header-coins.js` для предотвращения двойной обработки события `toggle-favorites-dropdown`
    - Убран модификатор `@click.stop` из шаблона `cmp-button` в `index.html`, так как `stopPropagation()` теперь вызывается явно в обработчике
    - Добавлен явный вызов `event.stopPropagation()` в методе `handleToggleFavoritesDropdown` для предотвращения всплытия события
    - Добавлена задержка 100ms перед сбросом флага `isTogglingFavorites` для предотвращения повторной обработки события
  * **Исправление проблемы с сохранением состояния чекбоксов**:
    - Модифицирован метод `fetchCoinGecko()` в `ui/api/coingecko.js` для фильтрации `selectedCoinIds` на основе вновь загруженных монет вместо полной очистки массива
    - Это сохраняет состояние выбранных чекбоксов для монет, которые остаются в списке после обновления
  * **Исправление проблемы с event.stopPropagation**:
    - Модифицирован метод `handleClick()` в `ui/components/button.js` для передачи нативного объекта события как первого аргумента в `$emit('click')`
    - Добавлен явный вызов `event.stopPropagation()` в `handleClick()` для предотвращения всплытия события
  * **Удаление отладочного логирования**:
    - Удалены все блоки `#region agent log` из `ui/components/button.js`
    - Удалены все блоки `#region agent log` из `ui/components/header-coins.js`
    - Удалены все блоки `#region agent log` из `ui/api/coingecko.js`
    - Удалены все блоки `#region agent log` из `ui/components/dropdown-menu.js`
- **Функциональность**: Выпадающее меню кнопки "Избранное" теперь открывается и закрывается корректно без двойной обработки событий. Состояние чекбоксов сохраняется при обновлении данных. Код очищен от отладочного логирования.

## MM (математическая модель)

## Architect (архитектура, настройки)

### Коммит: Start of day: 12-14
- **Что сделано**: Открыт новый рабочий день 14 декабря 2025
- **Как сделано**:
  * Проведена проверка документации проекта (`.cursorrules`, `architect.md`, `ui/guide-ii.md`)
  * Проверено состояние репозитория (чистое рабочее дерево, синхронизировано с `origin/master`)
  * Проверены текущие версии зависимостей (Vue.js 3.5.25, Bootstrap 5.3.8, Font Awesome 6.5.1)
  * Создан файл дневного лога `history/2025/12-14.txt`
  * Обновлен `lastCommitMessage` в `core/cfg-app.js` на "Start of day: 12-14"
- **Функциональность**: Зафиксировано начало рабочего дня в истории репозитория, обеспечена преемственность документации и правил работы ИИ-агента

